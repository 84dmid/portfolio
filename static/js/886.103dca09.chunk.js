"use strict";(self.webpackChunkportfolio=self.webpackChunkportfolio||[]).push([[886],{886:(t,i,e)=>{e.r(i),e.d(i,{initGame:()=>E});const s=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1],[1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1],[1,3,1,0,0,1,2,1,0,0,0,1,2,1,1,2,1,0,0,0,1,2,1,0,0,1,3,1],[1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1],[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],[1,2,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1],[1,2,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1],[1,2,2,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,2,2,2,1],[1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1],[0,0,0,0,0,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,0,0,0,0,0],[0,0,0,0,0,1,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,1,0,0,0,0,0],[0,0,0,0,0,1,2,1,1,2,1,1,1,7,7,1,1,1,2,1,1,2,1,0,0,0,0,0],[1,1,1,1,1,1,2,1,1,2,1,6,6,6,6,6,6,1,2,1,1,2,1,1,1,1,1,1],[4,0,0,0,0,0,2,2,2,2,1,6,6,6,6,6,6,1,2,2,2,2,0,0,0,0,0,4],[1,1,1,1,1,1,2,1,1,2,1,6,6,6,6,6,6,1,2,1,1,2,1,1,1,1,1,1],[0,0,0,0,0,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,0,0,0,0,0],[0,0,0,0,0,1,2,1,1,2,2,2,2,2,2,2,2,2,2,1,1,2,1,0,0,0,0,0],[0,0,0,0,0,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,0,0,0,0,0],[1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1],[1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1],[1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1],[1,2,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1],[1,3,2,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,2,3,1],[1,1,1,2,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,1],[1,1,1,2,1,1,2,1,1,2,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,1,1],[1,2,2,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,2,1,1,2,2,2,2,2,2,1],[1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1],[1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1],[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];const h=class{constructor(t){this.marking=s,this.cellSize=20,this.colsNum=this.marking[0].length,this.rowsNum=this.marking.length,this.height=this.cellSize*this.rowsNum,this.width=this.cellSize*this.colsNum,this.dotsNumber=0,this.map=this.createMap()}createMap(){const t=[];let i;return this.marking.forEach(((e,s)=>{t[s]=[],e.forEach(((e,h)=>{const a={x:h*this.cellSize+this.cellSize/2,y:s*this.cellSize+this.cellSize/2,type:e,rowInd:s,colInd:h};switch(e){case S.CELL_TYPE.LITTLE_DOT:case S.CELL_TYPE.BIG_DOT:this.dotsNumber++;break;case S.CELL_TYPE.PORTAL:i?(i.exitPortal=a,a.exitPortal=i):i=a,this.exitPoint=this.leftPortal,this.rightPortal=a}t[s][h]=a}))})),t}getCellByCoords(t,i){let e=Math.floor(i/this.cellSize),s=Math.floor(t/this.cellSize);return this.map[e][s]}checkDirection(t,i,e,s){const h=t+e.x*this.cellSize,a=i+e.y*this.cellSize,n=this.getCellByCoords(h,a);return n.type===S.CELL_TYPE.GHOST_HOME_DOOR?s:n.type!==S.CELL_TYPE.WALL}};const a=class{constructor(t){this.game=t,this.x=null,this.y=null,this.direction=null,this.stepSize=null}isInCenterCell(){const t=this.game.grid.cellSize,i=(this.x-t/2)%t===0,e=(this.y-t/2)%t===0;return i&&e}move(){this.x=this.x+this.direction.x*this.stepSize,this.y=this.y+this.direction.y*this.stepSize}checkAndHandlePortalCollision(){const t=this.game.grid.getCellByCoords(this.x,this.y);t.type===S.CELL_TYPE.PORTAL&&(this.x=t.exitPortal.x,this.y=t.exitPortal.y)}isDirectionsOpposite(t){return this.direction.x===-t.x&&this.direction.y===-t.y}};class n{constructor(t,i){this.game=t,this.view=i,this.startButton=document.getElementById("startButton"),this.stopButton=document.getElementById("pauseButton"),this.continueButton=document.getElementById("continueButton"),this.rightButton=document.getElementById("rightButton"),this.leftButton=document.getElementById("leftButton"),this.upButton=document.getElementById("upButton"),this.downButton=document.getElementById("downButton"),this.keyDownHandler=this.keyDownHandler.bind(this),this.startButton.addEventListener("click",(()=>{this.game.start()})),this.continueButton.addEventListener("click",(()=>{this.game.continue()})),this.stopButton.addEventListener("click",(()=>{this.game.setPause()})),this.rightButton.addEventListener("click",(()=>this.game.pacMan.setNewDirection(n.DIRECTION.RIGHT))),this.leftButton.addEventListener("click",(()=>this.game.pacMan.setNewDirection(n.DIRECTION.LEFT))),this.upButton.addEventListener("click",(()=>this.game.pacMan.setNewDirection(n.DIRECTION.UP))),this.downButton.addEventListener("click",(()=>this.game.pacMan.setNewDirection(n.DIRECTION.DOWN))),document.addEventListener("keydown",this.keyDownHandler)}keyDownHandler(t){"Right"===t.key||"ArrowRight"===t.key?this.game.pacMan.setNewDirection(S.DIRECTION.RIGHT):"Left"===t.key||"ArrowLeft"===t.key?this.game.pacMan.setNewDirection(S.DIRECTION.LEFT):"Up"===t.key||"ArrowUp"===t.key?this.game.pacMan.setNewDirection(S.DIRECTION.UP):"Down"!==t.key&&"ArrowDown"!==t.key||this.game.pacMan.setNewDirection(S.DIRECTION.DOWN)}}n.DIRECTION={RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"};const r=n;const o=class extends a{constructor(t){super(),this.game=t,this.stepSize=2,this.setInitParams()}setInitParams(){var t=this.game.grid;this.x=t.width/2,this.y=26*t.cellSize+t.cellSize/2,this.direction={x:1,y:0}}setNewDirection(t){switch(this.newDirection={x:0,y:0},t){case r.DIRECTION.RIGHT:this.newDirection.x=1;break;case r.DIRECTION.LEFT:this.newDirection.x=-1;break;case r.DIRECTION.DOWN:this.newDirection.y=1;break;case r.DIRECTION.UP:this.newDirection.y=-1}this.isDirectionsOpposite(this.newDirection)&&this.updateDirection()}update(){this.isInCenterCell()&&(this.checkAndHandlePortalCollision(),this.updateDirection(),!this.game.grid.checkDirection(this.x,this.y,this.direction))||this.move()}updateDirection(){this.newDirection&&this.game.grid.checkDirection(this.x,this.y,this.newDirection)&&(this.direction=this.newDirection,this.newDirection=void 0)}};const T=class extends a{constructor(t,i){super(),this.game=t,this.type=i,this.targetForScattering=this.getTargetForScattering(),this.targetForGoingOut={x:this.game.grid.width/2,y:14*this.game.grid.cellSize+this.game.grid.cellSize/2},this.targetForGoingToRespawn={x:this.game.grid.width/2,y:17*this.game.grid.cellSize+this.game.grid.cellSize/2},this.setInitParams()}setInitParams(){this.direction={x:-1,y:0},this.stepSize=2,this.frightenedTimeout=null;const t=this.game.grid.cellSize,i=this.game.grid.width;if(this.type===S.GHOST_TYPE.RED){const e=14;this.x=i/2,this.y=e*t+t/2,this.state=S.GHOST_STATE.IS_SCATTERING}else if(this.type===S.GHOST_TYPE.PINK){const e=17;this.x=i/2-t,this.y=e*t+t/2,this.state=S.GHOST_STATE.IS_GOING_OUT}else if(this.type===S.GHOST_TYPE.BLUE){const e=17;this.x=i/2,this.y=e*t+t/2,this.state=S.GHOST_STATE.IS_SCATTERING}else if(this.type===S.GHOST_TYPE.ORANGE){const e=17;this.x=i/2+t,this.y=e*t+t/2,this.state=S.GHOST_STATE.IS_SCATTERING}}get state(){return this._state}set state(t){this._state=t,this.isBlinking&&(this.isBlinking=!1),this.blinkingTimeout&&clearTimeout(this.blinkingTimeout)}getTargetForScattering(){switch(this.type){case S.GHOST_TYPE.RED:return{x:26*this.game.grid.map.length-this.game.grid.cellSize/2,y:this.game.grid.cellSize/2};case S.GHOST_TYPE.PINK:return{x:3*this.game.grid.cellSize-this.game.grid.cellSize/2,y:this.game.grid.cellSize/2};case S.GHOST_TYPE.BLUE:return{x:26*this.game.grid.cellSize-this.game.grid.cellSize/2,y:this.game.grid.map.length*this.game.grid.cellSize-this.game.grid.cellSize/2};case S.GHOST_TYPE.ORANGE:return{x:3*this.game.grid.cellSize-this.game.grid.cellSize/2,y:this.game.grid.map.length*this.game.grid.cellSize-this.game.grid.cellSize/2}}}getTargetForChasing(){const t=this.game.pacMan;return{[S.GHOST_TYPE.RED]:function(){return{x:t.x,y:t.y}}.bind(this),[S.GHOST_TYPE.PINK]:function(){const i=this.game.grid.cellSize;return{x:t.x+4*t.direction.x*i,y:t.y+4*t.direction.y*i}}.bind(this),[S.GHOST_TYPE.BLUE]:function(){const i=this.game.ghostsStore[S.GHOST_TYPE.RED],e=2*(i.x-t.x),s=2*(i.y-t.y);return{x:i.x+e,y:i.y+s}}.bind(this),[S.GHOST_TYPE.ORANGE]:function(){const i=this.game.grid.cellSize;return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))>8*i?{x:this.targetForScattering.x,y:this.targetForScattering.y}:{x:t.x,y:t.y}}.bind(this)}[this.type]()}setFright(){if(this.isInHome()||this.isInDoor()||this.state===S.GHOST_STATE.IS_GOING_TO_RESPAWN)return;this.state=S.GHOST_STATE.IS_FRIGHTENED,this.direction.x=-this.direction.x,this.direction.y=-this.direction.y,this.frightenedTimeout&&clearTimeout(this.frightenedTimeout),this.frightenedTimeout=setTimeout((()=>{this.state=S.GHOST_STATE.IS_CHASING}),15e3),this.blinkingTimeout=setTimeout((()=>{this.isBlinking=!0}),12e3)}goToRespawn(){this.state=S.GHOST_STATE.IS_GOING_TO_RESPAWN}isInHome(){return this.game.grid.getCellByCoords(this.x,this.y).type===S.CELL_TYPE.GHOST_HOME}isInDoor(){return this.game.grid.getCellByCoords(this.x,this.y).type===S.CELL_TYPE.GHOST_HOME_DOOR}isScatterTime(){const t=Math.round((Date.now()-this.game.startTime)/1e3);return t<7||t>27&&t<34||t>54&&t<61||t>81&&t<85}getTarget(){switch(this.state){case S.GHOST_STATE.IS_SCATTERING:return this.targetForScattering;case S.GHOST_STATE.IS_CHASING:return this.getTargetForChasing();case S.GHOST_STATE.IS_FRIGHTENED:return null;case S.GHOST_STATE.IS_GOING_TO_RESPAWN:return this.targetForGoingToRespawn;case S.GHOST_STATE.IS_GOING_OUT:return this.targetForGoingOut}}getDistanceToTarget(t,i){let e=this.getTarget();return Math.sqrt(Math.pow(e.x-t,2)+Math.pow(e.y-i,2))}getNextCellCenterCoords(t){return{x:this.x+t.x*this.game.grid.cellSize,y:this.y+t.y*this.game.grid.cellSize}}getNewDirection(){const t=[];if([{x:1,y:0},{x:-1,y:0},{x:0,y:-1},{x:0,y:1}].forEach((i=>{if(!this.isDirectionsOpposite(i)){const e=this.state===S.GHOST_STATE.IS_GOING_OUT||this.state===S.GHOST_STATE.IS_GOING_TO_RESPAWN;this.game.grid.checkDirection(this.x,this.y,i,e)&&t.push({...i})}})),1===t.length)return t[0];if(this.state===S.GHOST_STATE.IS_FRIGHTENED)return t[Math.floor(Math.random()*t.length)];let i,e;return t.forEach(((t,s)=>{const{x:h,y:a}=this.getNextCellCenterCoords(t),n=this.getDistanceToTarget(h,a);(!e||n<e)&&(e=n,i=s)})),t[i]}update(){this.isInCenterCell()&&(this.checkAndHandlePortalCollision(),this.direction=this.getNewDirection(),this.state===S.GHOST_STATE.IS_FRIGHTENED?this.stepSize=S.STEP_SIZE.LITTLE:this.state===S.GHOST_STATE.IS_GOING_TO_RESPAWN?this.stepSize=S.STEP_SIZE.BIG:this.stepSize=S.STEP_SIZE.NORMAL,this.isInHome()?(this.state===S.GHOST_STATE.IS_GOING_TO_RESPAWN&&(this.state=S.GHOST_STATE.IS_GOING_OUT),(this.game.score>30&&this.type===S.GHOST_TYPE.BLUE||this.game.score>90&&this.type===S.GHOST_TYPE.ORANGE)&&(this.state=S.GHOST_STATE.IS_GOING_OUT)):this.isScatterTime()?this.state!==S.GHOST_STATE.IS_GOING_OUT&&this.state!==S.GHOST_STATE.IS_CHASING||(this.state=S.GHOST_STATE.IS_SCATTERING):this.state!==S.GHOST_STATE.IS_SCATTERING&&this.state!==S.GHOST_STATE.IS_GOING_OUT||(this.state=S.GHOST_STATE.IS_CHASING)),this.move()}};class c{constructor(){this.setInitParams()}setInitParams(){this.movingCharacter=new a(this),this.grid=new h(this),this.field=this.grid.map,this.pacMan=new o(this),this.ghostsStore={[c.GHOST_TYPE.RED]:new T(this,c.GHOST_TYPE.RED),[c.GHOST_TYPE.PINK]:new T(this,c.GHOST_TYPE.PINK),[c.GHOST_TYPE.BLUE]:new T(this,c.GHOST_TYPE.BLUE),[c.GHOST_TYPE.ORANGE]:new T(this,c.GHOST_TYPE.ORANGE)},this.ghosts=Object.values(this.ghostsStore),this.state=c.STATE.IS_STOPPED,this.startTime=Date.now(),this.score=0,this.isWin=!1,this.lives=c.LIVES_AMOUNT,this.isPacManStep=!0}start(){this.setInitParams(),setTimeout((()=>{this.startTime=Date.now(),this.state=c.STATE.IS_RUNNING}),500)}setPause(){this.state!==c.STATE.IS_OVER&&(this.state=c.STATE.IS_STOPPED)}continue(){this.state!==c.STATE.IS_OVER&&(this.state=c.STATE.IS_RUNNING)}update(){if(this.state!==c.STATE.IS_STOPPED&&this.state!==c.STATE.IS_OVER){this.isPacManStep?(this.isPacManStep=!this.isPacManStep,this.pacMan.update(),this.checkAndHandleDotCollision()):(this.isPacManStep=!this.isPacManStep,this.ghosts.forEach((t=>t.update())));for(let t=0;t<this.ghosts.length;t++){const i=this.ghosts[t];if(this.grid.getCellByCoords(this.pacMan.x,this.pacMan.y)===this.grid.getCellByCoords(i.x,i.y)&&i.state!=c.GHOST_STATE.IS_GOING_TO_RESPAWN){if(i.state!==c.GHOST_STATE.IS_FRIGHTENED)return void this.handleLivesDecrement();i.goToRespawn()}}}}handleLivesDecrement(){this.lives>1?(this.state=c.STATE.IS_STOPPED,setTimeout((()=>{this.lives--,this.ghosts.forEach((t=>t.setInitParams())),this.pacMan.setInitParams(),setTimeout((()=>{this.state=c.STATE.IS_RUNNING}),1e3)}),1e3)):(this.lives--,this.state=c.STATE.IS_OVER)}checkAndHandleDotCollision(){const t=this.grid.getCellByCoords(this.pacMan.x,this.pacMan.y);t.type!==c.CELL_TYPE.LITTLE_DOT&&t.type!==c.CELL_TYPE.BIG_DOT||(this.score++,this.score===this.grid.dotsNumber&&(this.isWin=!0,this.state=c.STATE.IS_OVER),t.type===c.CELL_TYPE.BIG_DOT&&this.ghosts.forEach((t=>{t.setFright()})),t.type=c.CELL_TYPE.EMPTY)}}c.DIRECTION={RIGHT:"right",LEFT:"left",UP:"up",DOWN:"down"},c.CELL_TYPE={EMPTY:0,WALL:1,LITTLE_DOT:2,BIG_DOT:3,PORTAL:4,GHOST_HOME:6,GHOST_HOME_DOOR:7},c.GHOST_TYPE={RED:"red",PINK:"pink",BLUE:"aqua",ORANGE:"orange"},c.GHOST_STATE={IS_GOING_OUT:"isGoingOut",IS_GOING_TO_RESPAWN:"isGoingToRespawn",IS_FRIGHTENED:"isFrightened",IS_SCATTERING:"isScattering",IS_CHASING:"isChasing"},c.STATE={IS_STOPPED:"isStopped",IS_RUNNING:"isRunning",IS_OVER:"isOver"},c.STEP_SIZE={LITTLE:1,NORMAL:2,BIG:5},c.SPEED={SLOW:1,NORMAL:2,FAST:3,SUPER_FAST:4},c.LIVES_AMOUNT=3;const S=c;const l=class{constructor(t){this.game=t,this.canvas=document.getElementById("canvas"),this.canvas.width=t.grid.width,this.canvas.height=t.grid.height,this.canvas.style.backgroundColor="rgb(92, 92, 92)",this.cellSize=t.grid.cellSize,this.ctx=this.canvas.getContext("2d"),this.draw(t),this.lastFrameTime=0,this.frameInterval=10,this.gameSpeed=S.SPEED.NORMAL}_drawPoint(t,i,e,s){this.ctx.beginPath(),this.ctx.fillStyle=s,this.ctx.arc(t,i,e,0,2*Math.PI),this.ctx.fill(),this.ctx.closePath()}_drawRect(t,i,e,s,h){this.ctx.beginPath(),this.ctx.fillStyle=h,this.ctx.fillRect(t-e/2,i-s/2,e,s),this.ctx.closePath()}draw(t){const i=Date.now();if(i-this.lastFrameTime>this.frameInterval){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let t=this.gameSpeed;t>0;t--)this.game.update();this.drawField(this.game.field),this.drawScore(this.game.score),this.drawPacMan(this.game.pacMan),this.drawLives(this.game.lives),this.game.ghosts.forEach((t=>{this.drawGhost(t)})),this.game.state===S.STATE.IS_OVER&&this.drawGameOver(this.game),this.lastFrameTime=i}window.requestAnimationFrame(this.draw.bind(this,t))}drawField(t){t.forEach((t=>{t.forEach((t=>{t.type===S.CELL_TYPE.WALL&&this._drawRect(t.x,t.y,this.cellSize,this.cellSize,"black"),t.type===S.CELL_TYPE.LITTLE_DOT?this._drawPoint(t.x,t.y,3,"orange"):t.type===S.CELL_TYPE.BIG_DOT?this._drawPoint(t.x,t.y,6,"orange"):t.type===S.CELL_TYPE.GHOST_HOME_DOOR&&this._drawRect(t.x,t.y,this.cellSize,3,"grey")}))}))}drawScore(t){this.ctx.beginPath(),this.ctx.fillStyle="orange",this.ctx.font="20px Arial",this.ctx.fillText("Score: ".concat(t),20,40),this.ctx.closePath()}drawPacMan(t){this._drawPoint(t.x,t.y,10,"yellow")}drawGhost(t){let i;i=t.state===S.GHOST_STATE.IS_FRIGHTENED?t.isBlinking&&Math.floor(Date.now()/100)%2===0?t.type:"blue":t.state===S.GHOST_STATE.IS_GOING_TO_RESPAWN?"white":t.type,this._drawPoint(t.x,t.y,10,i)}drawLives(t){const i=this.canvas.width-10;for(let e=t;e>0;e--)this._drawPoint(i-24*e,30,10,"yellow")}drawGameOver(t){const i=t.isWin?"YOU WIN":"GAME OVER";this.ctx.font="".concat(70,"px Arial");const e=this.ctx.measureText(i).width,s=(this.canvas.width-e)/2,h=this.canvas.height/2;this.ctx.fillStyle="rgba(0, 0, 0, 0.5)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="lightgrey",this.ctx.fillText(i,s,h)}},E=()=>{const t=new S,i=new l(t);new r(t,i)}}}]);
//# sourceMappingURL=886.103dca09.chunk.js.map